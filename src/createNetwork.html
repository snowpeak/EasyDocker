<!DOCTYPE html>
<!--
    Easy Docker - Create network page.
    @author Latte Beo
-->
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="./css/bootstrap.min.css" />
    <link rel="stylesheet" href="./fontawesome/css/all.css" />
    <link rel="stylesheet" href="./css/easydocker.css" />

    <!-- ============================ -->
    <!-- JS読み込み                    -->
    <!-- ============================ -->
    <script>
        // JSが動かない対策 https://miyanetdev.com/archives/1162
        if (typeof module === 'object') {
            window.module = module;
            module = undefined;
        }
    </script>
    <!-- https://cdn.jsdelivr.net/npm/vue -->
    <script src="./js/vue.js"></script>
    
    <script>if (window.module) module = window.module;</script>

    <title>Easy Docker - Create Network</title>
</head>

<body>
    <div class="container">
        <div id="app">
            <div class="row bs-callout bs-callout-info">
            <h4 id="dealing-with-specificity">{{$t("createNetwork.title")}}</h4>
        </div>
            <form>
                <div class="form-group row">
                    <label for="name"
                        class="col-sm-4 col-form-label">{{$t("createNetwork.name")}}</label>
                    <div class="col-sm-6">
                        <input type="text" class="form-control"
                            id="name" v-model="name" />
                    </div>
                </div>
                <!-- button -->
                <div class="form-group row">
                    <div class="col-sm-3"></div>
                    <div class="col-sm-auto">
                        <button type="button" class="btn btn-success"  @click="doSubmit()">
                          <span id="spinner" class="spinner-border spinner-border-sm" role="status" style="display:none"></span>
                          <span>{{$t("common.create")}}</span>
                         </button>
                        <button type="button" class="btn btn-light"
                            @click="window.close()">{{$t("common.cancel")}}</button>
                    </div>
                    <div class="col-sm-2"></div>
                </div>
            </form>
        </div>
    </div>
    

    <script>
        const dockerAPI = require('./dockerAPI');
        const { ipcRenderer } = require('electron');
        const vuei18n = require('vue-i18n');
        Vue.use(vuei18n);
        const i18n = new vuei18n({
            locale : 'ja',
            messages : {
                ja : require('./messages_ja.json'),
                en : require('./messages_en.json')
            }
        })
        var app = new Vue({
            i18n : i18n, 
            el: '#app',
            data: {
                name: "",
            },
            methods: {
                doInit : function(x_locale){
                    i18n.locale = x_locale;
                },
                doSubmit: function () {
                    if(this.running){
                        alert(this.$t('common.inprogress'))
                        return
                    }
                    $('#alertMsg').css("display", "none");
                    $('#spinner').css("display", "");
                    this.running = true;
                    console.log(this.name);
                    ipcRenderer.send('async_createNetwork_create', this.name)
                },
            }
        })

        // メインプロセスからの通信受け取り
        ipcRenderer.on('async_createNetwork_set', function (event, x_locale) {
            app.doInit(x_locale)
        })

        // メインプロセスからの通信受け取り
        ipcRenderer.on('async_createNetwork_create_res', function (event, x_errMsg) {
            app.msg = x_errMsg;
            $('#alertMsg').css("display", "");
            $('#spinner').css("display", "none");
            app.running = false;
        })

    </script>

    <!-- ================================= -->
    <!-- JS読み込み(Bootstrapは最後らしい)   -->
    <!-- ================================= -->
    <script>
        // JSが動かない対策 https://miyanetdev.com/archives/1162
        if (typeof module === 'object') {
            window.module = module;
            module = undefined;
        }
    </script>
    <!-- https://code.jquery.com/jquery-3.3.1.slim.min.js -->
    <script src="./js/jquery-3.3.1.slim.min.js"></script>
    
    <!-- https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js -->
    <script src="./js/popper.min.js"></script>
    <!-- https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js -->
    <script src="./js/bootstrap.min.js"></script>
    <script>
        $(function () {
          $('[data-toggle="tooltip"]').tooltip()
        })
    </script>

    <script>if (window.module) module = window.module;</script>
    </body>

</html>